from typing import List

import craid.eddb.Constants


class Vulnerability:

    def __init__(self, govt: str, influence: float, state_dict):
        self.govt = govt
        self.influence = influence
        self.state_list: List[int] = []

        for state in state_dict:
            xid: int = int(state['id'])
            if xid is Constants.STATE_RETREAT: self.state_list.append(xid)
            if xid is Constants.STATE_WAR: self.state_list.append(xid)
            if xid is Constants.STATE_CIVIL_WAR: self.state_list.append(xid)
            if xid is Constants.STATE_ELECTION: self.state_list.append(xid)
            if xid is Constants.STATE_OUTBREAK: self.state_list.append(xid)
            if xid is Constants.STATE_INFRASTRUCTURE_FAILURE: self.state_list.append(xid)
            if xid is Constants.STATE_EXPANSION: self.state_list.append(xid)
            # if xid is Constants.STATE_RETREAT: self.state_list.append(xid)
            # if xid is Constants.STATE_RETREAT: self.state_list.append(xid)
            # if xid is Constants.STATE_RETREAT: self.state_list.append(xid)

    def getShortString(self):
        war: List[str] = []
        if 4.5 >= self.influence > 0.0:
            war.append("LowInf")
        if self.govt == "Anarchy":
            war.append("Anarchy")

        if Constants.STATE_RETREAT in self.state_list:
            war.append("Retreat")

        if Constants.STATE_WAR in self.state_list:
            war.append("War")
        if Constants.STATE_CIVIL_WAR in self.state_list:
            war.append("CivilWar")
        if Constants.STATE_ELECTION in self.state_list:
            war.append("Election")

        if Constants.STATE_OUTBREAK in self.state_list:
            war.append("Outbreak")
        if Constants.STATE_INFRASTRUCTURE_FAILURE in self.state_list:
            war.append("InfFail")
        if Constants.STATE_EXPANSION in self.state_list:
            war.append("Expans")

        if len(war) == 0:
            return ""
        return ",".join(war)

    # def getSort(self):
    # return [{'column_id': 'distance', 'direction': 'asc'}]
